---
title: "Sound Effects"
description: "Make your game heard — NES audio with the APU's pulse channel."
pubDate: 2026-01-10
game: 1
gameName: "Neon Nexus"
unit: 14
totalUnits: 64
system: "Nintendo Entertainment System"
tags: ["assembly", "6502", "audio", "apu"]
prevLesson: "/nintendo-entertainment-system/assembly/game-01-neon-nexus/unit-13"
nextLesson: "/nintendo-entertainment-system/assembly/game-01-neon-nexus/unit-15"
layout: "../../../../layouts/UnitLayout.astro"
---

import CodeFromFile from "@components/CodeFromFile.astro";

## What You're Building

A silent game feels incomplete. Sound effects provide crucial feedback — you know you've collected something or been hit without even looking.

By the end of this unit, you'll have:

- Basic APU (Audio Processing Unit) setup
- A rising "ding" sound for collecting items
- A falling "thud" sound for getting hit
- A sound update system that runs each frame

The game finally has a voice.

## The NES APU

The NES has five sound channels:

- **Pulse 1 & 2**: Square waves with adjustable duty cycle
- **Triangle**: Triangle wave (good for bass)
- **Noise**: Noise generator (percussion, explosions)
- **DMC**: Sample playback

We'll use Pulse Channel 1 — it's simple and versatile.

## APU Registers

<CodeFromFile src="nintendo-entertainment-system/game-01-neon-nexus/unit-14/snippets/01-apu-registers.asm" />

The key insight: the period value (in LO/HI) controls pitch. **Lower period = higher pitch**, **higher period = lower pitch**.

## APU Initialisation

Enable the channel and set it to silence:

<CodeFromFile src="nintendo-entertainment-system/game-01-neon-nexus/unit-14/snippets/02-init-apu.asm" />

Setting volume to 0 in the control register silences the channel. We'll turn it up when playing sounds.

## Playing a Sound

When the player collects an item, trigger a sound:

<CodeFromFile src="nintendo-entertainment-system/game-01-neon-nexus/unit-14/snippets/03-play-sound.asm" />

We set:
- **sfx_type**: Which sound is playing
- **sfx_timer**: How many frames it lasts
- **Volume**: Maximum (15)
- **Pitch**: Starting pitch for this sound

## The Sound Update Loop

Each frame, update the active sound:

<CodeFromFile src="nintendo-entertainment-system/game-01-neon-nexus/unit-14/snippets/04-update-sound.asm" />

The trick: modify the pitch every few frames to create movement. Collecting raises the pitch (subtracting from period), getting hit lowers it (adding to period).

## Triggering Sounds

Call the sound routines when events happen:

<CodeFromFile src="nintendo-entertainment-system/game-01-neon-nexus/unit-14/snippets/05-trigger-sounds.asm" />

That's it. Call the trigger, let update_sound handle the rest.

## The Complete Code

Here's our program with sound effects:

<CodeFromFile src="nintendo-entertainment-system/game-01-neon-nexus/unit-14/nexus.asm" />

## Build It. Run It.

```bash
ca65 nexus.asm -o nexus.o
ld65 -C nes.cfg nexus.o -o nexus.nes
fceux nexus.nes
```

Play the game:

![Sound effects gameplay](/images/nintendo-entertainment-system/game-01-neon-nexus/unit-14/screenshot.png)

When you collect an item, you'll hear a rising "ding". When you hit an enemy, you'll hear a falling "thud". The game feels more alive.

## Why These Sound Patterns?

The sounds we chose have game design reasoning:

- **Collect (rising pitch)**: Feels rewarding, positive. The upward motion suggests success.
- **Hit (falling pitch)**: Feels negative, alarming. The downward motion suggests failure.

These aren't arbitrary — they're designed to communicate game state through sound.

## Understanding APU Pitch

The relationship between period and pitch is inverse:

```
Pitch frequency = CPU clock / (16 * (period + 1))
```

So:
- Period $40 (64) = ~27,840 Hz / 65 ≈ 428 Hz (high)
- Period $C0 (192) = ~27,840 Hz / 193 ≈ 144 Hz (low)

Lower period values produce higher frequencies. This is why we subtract to raise pitch and add to lower it.

## The Timer Pattern

Notice the `AND #%00000011` check in update_sound. This only modifies pitch when the timer's bottom two bits are 00 — every 4 frames. Without this, the pitch change would be too fast to hear clearly.

Slowing things down makes the pitch sweep audible and pleasant.

## What You've Learnt

- **APU basics**: Channel enable, duty cycle, volume, period
- **Sound triggers**: Starting a sound with type and timer
- **Sound updates**: Modifying pitch over time
- **Period vs pitch**: Inverse relationship
- **Frame timing**: Using AND to slow down changes
- **Game feel**: How audio feedback affects experience

## Next Unit

The game plays and sounds great. In Unit 15, we'll add a title screen and game states — proper game flow instead of jumping straight into action.
