---
title: "The River"
description: "Add logs to the water zone. Learn how to unify object handling for both cars and logs."
pubDate: 2026-01-03
game: 1
gameName: "Hop"
unit: 6
totalUnits: 16
system: "Commodore Amiga"
tags: ["assembly", "68000", "blitter", "game-loop"]
nextLesson: "/commodore-amiga/assembly/game-01-signal/unit-07"
layout: "../../../../layouts/UnitLayout.astro"
---

import CodeFromFile from "@components/CodeFromFile.astro";

*Need to catch up? Check out [Unit 5: Traffic Flow](/commodore-amiga/game-01-signal/unit-05).*

## What You're Building

The road is deadly. But the river is treacherous.

By the end of this unit, you'll have:

- Logs floating in the water zone
- A unified object system handling both cars and logs
- Different graphics for different object types

## Unified Object System

Cars and logs share most of their behaviour — they move horizontally, wrap at screen edges, and need clearing/drawing. The only differences:

1. **Graphics** — cars look different from logs
2. **Colour** — red for cars, brown for logs
3. **Position** — cars in road zone, logs in water zone

We can handle this with one object structure and a **type** field:

<CodeFromFile src="commodore-amiga/game-01-signal/unit-06/snippets/01-unified-object-system.asm" lang="asm" />

## Object Types

We'll define two types:

<CodeFromFile src="commodore-amiga/game-01-signal/unit-06/snippets/02-object-types.asm" lang="asm" />

When drawing, we select the graphic and colour based on type:

<CodeFromFile src="commodore-amiga/game-01-signal/unit-06/snippets/03-object-types.asm" lang="asm" />

## Log Graphics

Logs are wider than cars. We'll make them 32 pixels (2 words) wide:

<CodeFromFile src="commodore-amiga/game-01-signal/unit-06/snippets/04-log-graphics.asm" lang="asm" />

Drawing a 2-word-wide object requires updating the blit size and modulo:

<CodeFromFile src="commodore-amiga/game-01-signal/unit-06/snippets/05-log-graphics.asm" lang="asm" />

## Unified Object Data

Now we define all objects in one array:

<CodeFromFile src="commodore-amiga/game-01-signal/unit-06/snippets/06-unified-object-data.asm" lang="asm" />

## Drawing with Variable Width

The blit width depends on object type:

<CodeFromFile src="commodore-amiga/game-01-signal/unit-06/snippets/07-drawing-with-variable-width.asm" lang="asm" />

## Colour Per Type

We draw cars in plane 1 (colour 1 = red) and logs in plane 2 (colour 2 = brown).

Actually, for simplicity, let's draw everything in plane 1 and use different copper colours in different zones. The road shows colour 1 as red; the water shows colour 1 as brown.

We can change the playfield colours mid-screen via copper:

<CodeFromFile src="commodore-amiga/game-01-signal/unit-06/snippets/08-colour-per-type.asm" lang="asm" />

This is a neat trick — the same bitplane pixels appear as different colours depending on their vertical position!

## Build It. Run It.

```bash
vasmm68k_mot -Fhunkexe -kick1hunks -o hop -nosym hop.asm
xdftool hop.adf create + format "Hop" ofs + boot install boot1x + write hop + makedir s
echo "hop" > startup-sequence
xdftool hop.adf write startup-sequence s/startup-sequence
fs-uae --floppy_drive_0=hop.adf
```

You should see red cars on the road and brown logs floating in the water!

## What You've Learnt

- **Unified object systems** reduce code duplication
- **Type fields** differentiate behaviour within shared code
- **Variable blit width** handles different object sizes
- **Copper colour changes** make the same pixels appear differently in different zones

## The Complete Code

Here's the full `hop.asm` with cars and logs:

<CodeFromFile src="commodore-amiga/game-01-signal/unit-06/hop.asm" lang="asm" />

## Recap / Sanity Check

Before moving on, verify:

- [ ] Build succeeds with no errors
- [ ] Cars visible on the road (red)
- [ ] Logs visible in the water (brown)
- [ ] All objects move and wrap correctly
- [ ] Frog still moves correctly

## Next Unit

The river has logs, but jumping on them is still fatal.

In [Unit 7: Riding the Logs](/commodore-amiga/game-01-signal/unit-07), we'll implement platform mechanics — when the frog lands on a log, it rides along.
