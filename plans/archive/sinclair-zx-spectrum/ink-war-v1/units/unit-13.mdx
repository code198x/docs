---
title: "Two Player Mode"
description: "Add hotseat play so two humans can battle for territory."
pubDate: 2026-01-04
game: 1
gameName: "Ink War"
unit: 13
totalUnits: 16
system: "Sinclair ZX Spectrum"
tags: ["assembly", "z80", "input", "multiplayer"]
nextLesson: "/sinclair-zx-spectrum/assembly/game-01-ink-war/unit-14"
layout: "../../../../layouts/UnitLayout.astro"
---

import CodeFromFile from "@components/CodeFromFile.astro";

*Need to catch up? Check out [Unit 12: Title Screen](/sinclair-zx-spectrum/game-01-ink-war/unit-12).*

## What You're Building

The game is single-player only. Playing against the AI is fun, but sometimes you want to challenge a friend sitting next to you. Time to add hotseat multiplayer.

By the end of this unit, you'll have:

- A game mode selection menu (1 Player vs 2 Player)
- Turn-based hotseat play for two humans
- Proper labelling on the results screen (P1/P2 instead of Player/CPU)
- Both modes working with existing sound and visuals

![Mode selection on title screen](/images/sinclair-zx-spectrum/game-01-ink-war/unit-13/screenshot.png)

## The Plan

We need to:

1. **Add a game mode variable** — track whether we're in 1P or 2P mode
2. **Modify the title screen** — add mode selection
3. **Change turn handling** — skip AI when in 2P mode
4. **Update result labels** — show appropriate player names

## Game Mode Variable

Add a variable to track the game mode:

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-13/snippets/01-game-mode-variable.asm" lang="asm" />

Mode 1 is the existing AI opponent. Mode 2 is hotseat multiplayer where both players share the keyboard.

## Modifying the Title Screen

The title screen needs to show mode selection and handle input:

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-13/snippets/02-modifying-the-title-screen.asm" lang="asm" />

The new strings:

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-13/snippets/03-modifying-the-title-screen.asm" lang="asm" />

## Handling Mode Selection

Instead of just waiting for SPACE, we wait for either 1 or 2:

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-13/snippets/04-handling-mode-selection.asm" lang="asm" />

The 1 and 2 keys are on keyboard row $F7 (the number row 1-5). Bit 0 is "1", bit 1 is "2".

## Changing Turn Handling

The key change is in `claim_cell`. Currently, after the human claims, we call the AI:

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-13/snippets/05-changing-turn-handling.asm" lang="asm" />

We need to check the game mode first:

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-13/snippets/06-changing-turn-handling.asm" lang="asm" />

Wait — there's an issue. In the existing code, after claiming we always return player to 1 before calling AI (the AI temporarily sets player to 2). But we've already set `current_player` to 1 when storing the claim. Let me trace through more carefully.

Actually, looking at the existing `claim_cell`:
1. We store `current_player` (which is 1) into the board
2. We call AI routines which set player to 2, make the AI move, then set back to 1

For 2P mode, we need:
1. Store `current_player` into the board (could be 1 or 2)
2. Switch to the other player
3. That's it — no AI

The simpler approach:

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-13/snippets/07-changing-turn-handling.asm" lang="asm" />

**`xor 3`** — This is a neat trick. XOR with 3 (binary 11) flips the bottom two bits. 1 XOR 3 = 2. 2 XOR 3 = 1. Perfect for toggling between players!

## Updating Result Labels

The results screen currently shows "PLAYER" and "CPU". For 2P mode, we should show "PLAYER 1" and "PLAYER 2":

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-13/snippets/08-updating-result-labels.asm" lang="asm" />

New strings for 2P mode:

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-13/snippets/09-updating-result-labels.asm" lang="asm" />

## Winner Message for 2P

The winner message also needs updating. Currently we have `msg_player_wins` and `msg_cpu_wins`. For 2P mode, we need `msg_p1_wins` and `msg_p2_wins`:

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-13/snippets/10-winner-message-for-2p.asm" lang="asm" />

## Updating the Entry Point

Update `start` to call the new mode selection:

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-13/snippets/11-updating-the-entry-point.asm" lang="asm" />

## Build It. Run It.

```bash
pasmo --tapbas inkwar.asm inkwar.tap
```

Test both modes:

**1 Player (press 1):**
- Same as before — you vs the AI
- Results show "PLAYER" and "CPU"

**2 Player (press 2):**
- Both players use QAOP + SPACE
- Border shows whose turn it is (red/cyan)
- Players alternate after each claim
- Results show "PLAYER 1" and "PLAYER 2"

## Recap / Sanity Check

- Mode variable tracks 1P vs 2P
- Title screen offers mode selection (1 or 2 key)
- AI code is skipped in 2P mode
- Turn switching uses XOR 3 trick
- Result labels change based on mode
- All existing features (sound, scoring) work in both modes

## What You've Built

Comparing to Unit 12:

- **`game_mode`** — variable tracking 1P or 2P
- **`wait_for_mode`** — mode selection input handling
- **Updated `claim_cell`** — conditional AI vs human turn
- **Updated `show_results`** — mode-aware labels
- **New strings** — msg_mode1, msg_mode2, msg_p1, msg_p2, msg_p1_wins, msg_p2_wins

The game now supports both single-player and local multiplayer!

## What You've Learnt

- **Game modes** — Using a variable to change behaviour
- **Conditional logic** — Branching based on mode
- **XOR toggle** — `xor 3` to flip between 1 and 2
- **Keyboard scanning** — Reading specific keys (1 and 2)
- **Code reuse** — Same input/display code works for both modes

## The Complete Code

Here's `inkwar.asm` as it stands after Unit 13:

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-13/inkwar.asm" lang="asm" />

## Next Unit

The game now supports both solo and local multiplayer. But the AI is one-size-fits-all — no way to adjust difficulty.

In Unit 14, we'll add **Difficulty Levels** — letting players choose how tough the AI should be.
