---
title: "Scoring"
description: "Add a score tally and present results when the battle ends."
pubDate: 2026-01-04
game: 1
gameName: "Ink War"
unit: 10
totalUnits: 16
system: "Sinclair ZX Spectrum"
tags: ["assembly", "z80", "score", "ui"]
nextLesson: "/sinclair-zx-spectrum/assembly/game-01-ink-war/unit-11"
layout: "../../../../layouts/UnitLayout.astro"
---

import CodeFromFile from "@components/CodeFromFile.astro";

*Need to catch up? Check out [Unit 9: Win Detection](/sinclair-zx-spectrum/game-01-ink-war/unit-09).*

## What You're Building

The game ends, the border flashes, and... that's it. The player knows they won or lost by the border colour, but there's no fanfare, no numbers, no "PLAYER WINS" message. Time to give the ending some proper presentation.

By the end of this unit, you'll have:

- A results screen showing territory counts
- Text display using the ROM's print routines
- A clear winner announcement
- A proper "press space to play again" prompt

![Game over screen showing scores and winner](/images/sinclair-zx-spectrum/game-01-ink-war/unit-10/screenshot.png)

## The Spectrum's Print System

The ZX Spectrum ROM has a built-in print system. At address $10 (RST 16), there's a routine that prints whatever character is in the A register. Before using it, we need to open the correct "channel" — the screen is channel 2.

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-10/snippets/01-the-spectrum-s-print-system.asm" lang="asm" />

Once the channel is open, we can print characters with RST $10:

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-10/snippets/02-the-spectrum-s-print-system.asm" lang="asm" />

The cursor advances automatically after each character.

## Positioning the Cursor

The print system uses control codes. To position the cursor, we send:
- Code 22 (AT command)
- Y coordinate (row 0-23)
- X coordinate (column 0-31)

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-10/snippets/03-positioning-the-cursor.asm" lang="asm" />

## The Plan

We need to:

1. **Print strings** — a routine to print null-terminated text
2. **Print numbers** — convert `p1_count` and `p2_count` to digits
3. **Build the results screen** — show scores and winner
4. **Replace the simple flash** with the full results screen

## Printing Strings

Rather than printing character by character, let's create a routine that prints a string ending with a zero byte:

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-10/snippets/04-printing-strings.asm" lang="asm" />

Simple and effective. We load each byte, check if it's zero (end marker), print if not, advance, repeat.

## Printing Numbers

Our counts are single bytes, 0-64. We need to convert them to printable ASCII digits. This is a classic problem: divide by 10 repeatedly, collect the remainders.

For values up to 64, we need at most two digits:
- Tens digit (0-6)
- Units digit (0-9)

The Z80 doesn't have a divide instruction, but we can subtract repeatedly:

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-10/snippets/05-printing-numbers.asm" lang="asm" />

Wait — there's a problem. If the score is exactly 10, 20, 30 etc., we'd skip the leading zero but then only print "0". Let's fix that:

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-10/snippets/06-printing-numbers.asm" lang="asm" />

Actually, looking at this again — if a player scores 5, we print "5". If they score 50, we print "50". That's correct. The skip logic is fine for a game score display.

## Building the Results Screen

Now let's create the complete game over display:

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-10/snippets/07-building-the-results-screen.asm" lang="asm" />

## Message Data

We need to define our strings. Each ends with a zero byte:

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-10/snippets/08-message-data.asm" lang="asm" />

The extra spaces in "PLAYER:" and "CPU:" align the numbers.

## Updating check_game_over

Now we replace the simple border flash with the full results screen:

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-10/snippets/09-updating-check-game-over.asm" lang="asm" />

We've split the border setting into its own routine:

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-10/snippets/10-updating-check-game-over.asm" lang="asm" />

## New Instruction: RST

**`RST $10`** — This is a special single-byte call instruction. The Z80 has 8 RST instructions (RST 0, RST 8, RST 16, RST 24, RST 32, RST 40, RST 48, RST 56) that call fixed addresses. `RST $10` calls address $0010 — the Spectrum ROM's print routine. It's faster and smaller than `CALL $0010`.

The RST instructions exist because early computers needed compact code. One byte instead of three makes a real difference when you're printing lots of characters.

## Understanding System Variables

**Address 23693 ($5C8D)** — This is `ATTR_P`, the permanent attribute used when printing. Setting it controls the ink and paper colours for subsequent text output.

The Spectrum ROM maintains many such system variables in the range 23552-23733. We're not manipulating them heavily, but knowing they exist is useful.

## Build It. Run It.

```bash
pasmo --tapbas inkwar.asm inkwar.tap
```

Play a full game. When the board fills:

- Screen clears to show results
- "GAME OVER" appears at the top
- Both scores display (e.g., "PLAYER: 35" and "CPU: 29")
- Winner announcement shows
- "PRESS SPACE" prompt appears
- Border reflects the winner
- SPACE restarts cleanly

## Recap / Sanity Check

- ROM print routine (RST $10) outputs characters
- Channel 2 must be opened before printing
- Control code 22 positions the cursor
- Division by subtraction extracts digits
- Null-terminated strings end with zero byte
- System variables control print attributes

## What You've Built

Comparing to Unit 9:

- **`print_string`** — outputs null-terminated text
- **`print_number`** — converts byte to ASCII digits
- **`show_results`** — displays the full game over screen
- **`set_winner_border`** — sets border colour (extracted from old show_game_over)
- **Message data** — all the text strings

The game now has a proper ending screen with real information.

## What You've Learnt

- **ROM routines** — The Spectrum ROM provides useful functions
- **RST instructions** — Single-byte calls to fixed addresses
- **Print channels** — The Spectrum's I/O stream system
- **Control codes** — Positioning and formatting text
- **Integer to ASCII** — Converting numbers to printable digits
- **System variables** — ROM state stored at fixed addresses

## The Complete Code

Here's `inkwar.asm` as it stands after Unit 10:

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-10/inkwar.asm" lang="asm" />

## Next Unit

The game ends with a proper score display now. But it's eerily silent throughout. Every great game has sound feedback.

In Unit 11, we'll add **Sound Effects** — beeps for moves, claims, and victory.
