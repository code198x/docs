---
title: "The Attribute Grid"
description: "Master the 32×24 grid of colour cells. Calculate addresses, fill regions, and create patterns."
pubDate: 2026-01-09
game: 1
gameName: "Ink War"
unit: 2
totalUnits: 64
system: "Sinclair ZX Spectrum"
tags: ["assembly", "z80", "display", "attributes", "loops"]
prevLesson: "/sinclair-zx-spectrum/assembly/game-01-ink-war/unit-01"
nextLesson: "/sinclair-zx-spectrum/assembly/game-01-ink-war/unit-03"
layout: "../../../../layouts/UnitLayout.astro"
---

import CodeFromFile from "@components/CodeFromFile.astro";
import InlineNote from "../../../../components/units/InlineNote.astro";

## What You're Building

In Unit 1, we placed a few coloured cells by hand. But Ink War needs an 8×8 board — 64 cells. We need to understand the grid.

By the end of this unit, you'll have:

- A clear mental model of the 32×24 attribute grid
- Code to fill entire rows with colour
- A checkerboard pattern demonstrating position-based logic
- Understanding of BRIGHT colours

![Unit 2 Screenshot](/images/sinclair-zx-spectrum/game-01-ink-war/unit-02/screenshot.png)

## The Grid

The Spectrum screen has 256×192 pixels, but the attribute system divides it into a grid of 8×8 pixel cells:

- **32 columns** (256 ÷ 8 = 32)
- **24 rows** (192 ÷ 8 = 24)
- **768 cells total** (32 × 24)

Each cell has one attribute byte controlling its colours. These 768 bytes live at $5800-$5AFF.

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-02/snippets/01-grid-layout.asm" />

## Calculating Addresses

To colour a specific cell, we need its address. The formula is simple:

```
address = $5800 + (row × 32) + column
```

Row 0 is the top of the screen. Column 0 is the left edge.

| Position | Calculation | Address |
|----------|-------------|---------|
| Row 0, Col 0 | $5800 + 0 + 0 | $5800 |
| Row 0, Col 31 | $5800 + 0 + 31 | $581F |
| Row 1, Col 0 | $5800 + 32 + 0 | $5820 |
| Row 10, Col 15 | $5800 + 320 + 15 | $5800 + $14F = $594F |

The cells are stored row by row, 32 bytes per row.

## Clearing the Screen

Before drawing, we should clear the screen to a known state. We could loop through all 768 bytes, but there's a faster way: the Z80's `LDIR` instruction.

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-02/snippets/02-clear-screen.asm" />

`LDIR` means "Load, Increment, Repeat". It copies the byte at (HL) to (DE), increments both pointers, decrements BC, and repeats until BC reaches zero.

By setting the first byte and then copying it forward, we fill the entire area with the same value. This is much faster than a loop.

<InlineNote>
LDIR is one of the Z80's most useful instructions. You'll use it for clearing memory, copying data, and scrolling screens. Learn it well.
</InlineNote>

## Filling a Row

To fill a specific row with colour, we calculate its starting address and write 32 bytes:

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-02/snippets/03-fill-row.asm" />

`DJNZ` means "Decrement B and Jump if Not Zero". It's perfect for counted loops — load B with the count, and DJNZ handles the rest.

## The Checkerboard Pattern

A checkerboard alternates colours based on position. The trick: XOR the row number with the column number. If the result is odd, use one colour; if even, use another.

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-02/snippets/04-checkerboard.asm" />

This pattern is important for Ink War. Our game board will start as a checkerboard of potential moves, with players claiming cells to turn them their colour.

<InlineNote>
XOR (exclusive OR) returns 1 when the inputs differ. Row 0, Column 1: 0 XOR 1 = 1 (odd). Row 1, Column 1: 1 XOR 1 = 0 (even). This creates the alternating pattern.
</InlineNote>

## BRIGHT Colours

The Spectrum has 8 basic colours, but the BRIGHT bit doubles them (well, almost — bright black is still black). BRIGHT colours are more vivid and saturated.

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-02/snippets/05-bright-colours.asm" />

In our screenshot, the bottom two rows show this. Row 20 has normal colours; row 21 has the same colours with BRIGHT enabled. The difference is subtle but noticeable.

For Ink War, we'll use BRIGHT colours for player territories to make them stand out from the board.

## Build It. Run It.

```bash
pasmonext --sna inkwar.asm inkwar.sna
```

You should see:

- Three coloured bars at the top (red, green, blue)
- An 8×8 checkerboard in the centre
- A colour gradient at the bottom (normal then bright)

## What You've Learnt

- **Grid layout**: 32 columns × 24 rows = 768 attribute cells
- **Address calculation**: $5800 + (row × 32) + column
- **LDIR**: Fast block copy instruction
- **DJNZ**: Counted loop instruction
- **Checkerboard**: XOR row with column for alternating pattern
- **BRIGHT colours**: Bit 6 makes colours more vivid

## The Complete Code

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-02/inkwar.asm" />

## Next Unit

We can fill screens and create patterns. Now it's time to draw our actual game board — an 8×8 playing area with a border, positioned in the centre of the screen. The foundation of Ink War takes shape.
