---
title: "The Cursor"
description: "Create a movable cursor that responds to keyboard input. The first truly interactive element."
pubDate: 2026-01-09
game: 1
gameName: "Ink War"
unit: 6
totalUnits: 64
system: "Sinclair ZX Spectrum"
tags: ["assembly", "z80", "cursor", "movement", "game-loop"]
prevLesson: "/sinclair-zx-spectrum/assembly/game-01-ink-war/unit-05"
nextLesson: "/sinclair-zx-spectrum/assembly/game-01-ink-war/unit-07"
layout: "../../../../layouts/UnitLayout.astro"
---

import CodeFromFile from "@components/CodeFromFile.astro";
import InlineNote from "../../../../components/units/InlineNote.astro";

## What You're Building

We can read the keyboard. Now we need something to control.

By the end of this unit, you'll have:

- A visible cursor on the game board
- Cursor movement with Q/A/O/P keys
- Boundary checking (can't leave the board)
- The game loop pattern: read input, update state, draw

![Unit 6 Screenshot](/images/sinclair-zx-spectrum/game-01-ink-war/unit-06/screenshot.png)

*The yellow cell is the cursor. Move it with Q/A/O/P!*

## Cursor State

The cursor needs to remember its position. We store this in two variables:

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-06/snippets/01-cursor-variables.asm" />

Both values range from 0 to 7, covering the 8×8 board. The cursor starts at (3,3) — roughly the centre.

## Drawing the Cursor

The cursor is just a cell with a different colour. We use bright yellow to make it stand out:

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-06/snippets/02-draw-cursor.asm" />

The `get_cell_address` subroutine (from Unit 4) converts board coordinates to an attribute address.

<InlineNote>
We could use FLASH instead of a colour, making the cell blink. But a solid colour is easier to see in screenshots and makes debugging simpler. You can experiment with FLASH later.
</InlineNote>

## Erasing the Cursor

Before moving the cursor, we must erase it from the old position:

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-06/snippets/03-erase-cursor.asm" />

Without this, we'd leave yellow "ghost" cells everywhere the cursor has been. The pattern is always: **erase, move, draw**.

## Moving the Cursor

The move routine checks which keys are pressed and updates the position:

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-06/snippets/04-move-cursor.asm" />

We check for movement keys first — if none are pressed, we return immediately without erasing or redrawing.

## Boundary Checking

The cursor must stay within the 8×8 board. We check boundaries before allowing movement:

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-06/snippets/05-boundary-check.asm" />

The check happens *before* modifying the position. If we're at a boundary, we simply skip the increment or decrement.

## The Game Loop

Our main loop now has the classic game structure:

```asm
main_loop:
        halt                ; Wait for vertical blank
        call read_keys      ; 1. Read input
        call move_cursor    ; 2. Update state
        jr main_loop        ; 3. (Drawing happens in move_cursor)
```

This runs at 50Hz (once per frame). Each iteration:
1. Waits for the screen refresh
2. Reads the keyboard
3. Updates game state (cursor position)
4. Redraws if needed

## Build It. Run It.

```bash
pasmonext --sna inkwar.asm inkwar.sna
```

You should see:

- The game board with a yellow cursor cell
- Press Q → cursor moves up
- Press A → cursor moves down
- Press O → cursor moves left
- Press P → cursor moves right
- Cursor stops at board edges

## What You've Learnt

- **Cursor state**: Variables tracking position (row, column)
- **Erase-move-draw**: Pattern for smooth movement
- **Boundary checking**: Prevent cursor leaving valid area
- **Game loop**: Input → Update → Draw cycle
- **HALT timing**: Run at consistent frame rate

## The Complete Code

<CodeFromFile src="sinclair-zx-spectrum/game-01-ink-war/unit-06/inkwar.asm" />

## Next Unit

The cursor moves, but pressing Space does nothing. In Unit 7, we'll make Space claim the current cell — turning it to the current player's colour. The game mechanics begin.
