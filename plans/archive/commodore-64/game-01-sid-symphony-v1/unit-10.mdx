---
title: "Timing Windows"
description: "Precision matters. Add Perfect, Good, and Late grades with different point values to reward accurate timing."
pubDate: 2025-11-26
game: 1
gameName: "SID Symphony"
unit: 10
totalUnits: 16
system: "Commodore 64"
tags: ["assembly", "6510", "timing", "scoring", "feedback"]
prevLesson: "/commodore-64/assembly/game-01-sid-symphony/unit-09"
nextLesson: "/commodore-64/assembly/game-01-sid-symphony/unit-11"
layout: "../../../../layouts/UnitLayout.astro"
---

import CodeFromFile from "@components/CodeFromFile.astro";

## Beyond Hit or Miss

Until now, hitting a note anywhere in the hit zone gave the same reward. Press the key when the note is barely visible, or press it at the last possible moment — same points, same feedback.

Real rhythm games don't work this way. They grade your timing: Perfect, Great, Good, OK, Miss. Better timing means better scores. This precision is what separates casual play from mastery.

This unit divides our hit zone into timing windows, each with its own point value and visual feedback.

## Defining the Windows

Our hit zone is 8 columns wide (columns 0-7, where column 0 is the target line). We divide this into three grades:

| Grade | Columns | Points | Colour |
|-------|---------|--------|--------|
| Perfect | 0-2 | 15 | Green |
| Good | 3-5 | 10 | Yellow |
| Late | 6-7 | 5 | Red |

<CodeFromFile src="commodore-64/game-01-sid-symphony/unit-10/snippets/01-defining-the-windows.asm" lang="asm" />

The closer to the target line (column 0), the better the grade. Players who wait until the last moment get Perfect; those who press early get Late.

## Calculating the Grade

When a hit occurs, we check where the note was in the hit zone:

<CodeFromFile src="commodore-64/game-01-sid-symphony/unit-10/snippets/02-calculating-the-grade.asm" lang="asm" />

The `bcs` (branch if carry set) instruction branches when the comparison result is greater than or equal. So `cmp #ZONE_PERFECT` followed by `bcs` branches if the position is 3 or higher — meaning it's not Perfect.

## Showing the Grade

Each grade flashes briefly on screen in its track row. We store the grade text at column 15 (to the right of the hit zone), using simple absolute addressing since we know the exact screen locations:

<CodeFromFile src="commodore-64/game-01-sid-symphony/unit-10/snippets/03-showing-the-grade.asm" lang="asm" />

The drawing routines calculate the screen address from the row number:

<CodeFromFile src="commodore-64/game-01-sid-symphony/unit-10/snippets/04-showing-the-grade.asm" lang="asm" />

## Timer-Based Clearing

Each track has its own grade timer. Every frame, we check if any timer has expired and clear that track's grade text:

<CodeFromFile src="commodore-64/game-01-sid-symphony/unit-10/snippets/05-timer-based-clearing.asm" lang="asm" />

This pattern — countdown timer that triggers an action when it reaches zero — appears constantly in game programming. We'll use it again for combo displays, power-ups, and animations.

## Integration

The grade calculation replaces the old fixed-point scoring. In `check_hit_on_track`, we save the note position before erasing it, then call the grade calculation:

<CodeFromFile src="commodore-64/game-01-sid-symphony/unit-10/snippets/06-integration.asm" lang="asm" />

And in the main game loop, we add the grade text update:

<CodeFromFile src="commodore-64/game-01-sid-symphony/unit-10/snippets/07-integration.asm" lang="asm" />

## The Result

Play the game now. You'll see:

- "PERFECT" in green when you hit notes right at the target line
- "GOOD" in yellow for slightly early hits
- "LATE" in red for hits at the edge of the zone

Watch your score climb faster with precise timing. A song played perfectly scores 50% higher than one played sloppily.

## The Complete Code

<CodeFromFile src="commodore-64/game-01-sid-symphony/unit-10/symphony.asm" lang="asm" />

## What's Next

We have grades, but no way to chain them. In Unit 11, we add a **combo system** — consecutive Perfect hits multiply your score. The pressure builds.
